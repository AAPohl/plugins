{% extends "base_plugin.html" %}

{% set logo_frame = false %}

<!-- set update_interval to a value > 0 (in milliseconds) to enable periodic data updates -->
{% set update_interval = 0 %}

<!--
	Additional script tag for plugin specific javascript code go into this block
-->
{% block pluginscripts %}
<script>
	function handleUpdatedData(response, dataSet=null) {
		if (dataSet === 'devices_info' || dataSet === null) {
			var objResponse = JSON.parse(response);
			myProto = document.getElementById(dataSet);
			for (var device in objResponse) {
				<!--
				shngInsertText (device+'_source', objResponse[device]['source']);
				shngInsertText (device+'_powerState', objResponse[device]['powerState']);
				-->
			}
		}
	}
</script>
{% endblock pluginscripts %}


{% block headtable %}
<table class="table table-striped table-hover">
	<tbody>
		<tr>
			<td class="py-1"><strong>IP</strong></td>
			<td class="py-1">{{ p.get_ip() }}</td>
            <td class="py-1">{% if 'status_code' in p.get_items() %}<strong>{{ _('Status') }}</strong>{% endif %}</td>
            <td class="py-1">{% if 'status_code' in p.get_items() %}
                {% if p.get_items()['status_code']() == 0 %}Status wird ermittelt
                {% elif p.get_items()['status_code']() == 1 %}Automower parkt
                {% elif p.get_items()['status_code']() == 2 %}Automower mäht
                {% elif p.get_items()['status_code']() == 3 %}Automower sucht die Ladestation
                {% elif p.get_items()['status_code']() == 4 %}Automower lädt
                {% elif p.get_items()['status_code']() == 5 %}Automower sucht (wartet auf das Umsetzen im manuellen Modus)
                {% elif p.get_items()['status_code']() == 7 %}Fehlerstatus
                {% elif p.get_items()['status_code']() == 8 %}Schleifensignal verloren
                {% elif p.get_items()['status_code']() == 16 %}Automower abgeschaltet
                {% elif p.get_items()['status_code']() == 17 %}Automower schläft
                {% endif %}{% endif %}
            </td>
        </tr>
        <tr>
            <td class="py-1"><strong>{{ _('Benutzer') }}</strong></td>
			<td class="py-1">{{ p.get_user() }}</td>
            <td class="py-1"><strong>{{ _('Passwort') }}</strong></td>
			<td class="py-1">{{ p.get_parameter_value_for_display('password') }}
		</tr>
	</tbody>
</table>
{% endblock headtable %}


<!--
	Define the number of tabs for the body of the web interface (1 - 3)
-->
{% set tabcount = 1 %}
<!--
	Content block for the first tab of the Webinterface
-->
{% set tab1title = "<strong>" ~ p.get_shortname() ~ " Items</strong>" %}
{% block bodytab1 %}
<div class="container-fluid m-2">
    <table class="table table-striped table-hover pluginList">
        <thead>
            <tr class="shng_heading">
                <th>{{ _('Pfad') }}</th>
                <th>{{ _('Typ') }}</th>
                <th>{{ _('Robonect Datentyp') }}</th>
                <th>{{ _('Wert') }}</th>
                <th>{{ _('Letztes Update') }}</th>
                <th>{{ _('Letzter Change') }}</th>
            </tr>
        </thead>
        <tbody>
        <tr><td colspan="6"><strong>{{ _('Status-Informationen') }}</strong></td></tr>
        {% for key, item in p.get_items().items() %}
            <tr>
                <td class="py-1">{{ item.property.path }}</td>
                <td class="py-1">{{ item.property.type }}</td>
                <td class="py-1">{{ key }}</td>
                <td id="{{ item.id() }}_value" class="py-1">
                    {{ item()}}
                    {% if key == 'status_code' %}
                        : {% if item() == 0 %}Status wird ermittelt
                        {% elif item() == 1 %}Automower parkt
                        {% elif item() == 2 %}Automower mäht
                        {% elif item() == 3 %}Automower sucht die Ladestation
                        {% elif item() == 4 %}Automower lädt
                        {% elif item() == 5 %}Automower sucht (wartet auf das Umsetzen im manuellen Modus)
                        {% elif item() == 7 %}Fehlerstatus
                        {% elif item() == 8 %}Schleifensignal verloren
                        {% elif item() == 16 %}Automower abgeschaltet
                        {% elif item() == 17 %}Automower schläft
                        {% endif %}
                    {% elif key == 'status_mode' %}
                        : {% if item() == 0 %}Auto
                        {% elif item() == 1 %}Manuell
                        {% elif item() == 2 %}Home
                        {% elif item() == 3 %}Demo
                        {% endif %}
                    {% endif %}
                </td>
                <td id="{{ item.id() }}_last_update" class="py-1">{{ item.property.last_update.strftime('%d.%m.%Y %H:%M:%S') }}</td>
                <td id="{{ item.id() }}_last_change" class="py-1">{{ item.property.last_change.strftime('%d.%m.%Y %H:%M:%S') }}</td>
            </tr>
        {% endfor %}
        <tr><td colspan="6"><strong>{{ _('Batterie-Informationen') }}</strong></td></tr>
        {% for key, items in p.get_battery_items().items() %}
            {% for item in items %}
            <tr>
                <td class="py-1">{{ item.property.path }}</td>
                <td class="py-1">{{ item.property.type }}</td>
                <td class="py-1">{{ key }}</td>
                <td id="{{ item.id() }}_value" class="py-1">
                    {{ item()}}
                    {% if key == 'status_code' %}
                        : {% if item() == 0 %}Status wird ermittelt
                        {% elif item() == 1 %}Automower parkt
                        {% elif item() == 2 %}Automower mäht
                        {% elif item() == 3 %}Automower sucht die Ladestation
                        {% elif item() == 4 %}Automower lädt
                        {% elif item() == 5 %}Automower sucht (wartet auf das Umsetzen im manuellen Modus)
                        {% elif item() == 7 %}Fehlerstatus
                        {% elif item() == 8 %}Schleifensignal verloren
                        {% elif item() == 16 %}Automower abgeschaltet
                        {% elif item() == 17 %}Automower schläft
                        {% endif %}
                    {% elif key == 'status_mode' %}
                        : {% if item() == 0 %}Auto
                        {% elif item() == 1 %}Manuell
                        {% elif item() == 2 %}Home
                        {% elif item() == 3 %}Demo
                        {% endif %}
                    {% endif %}
                </td>
                <td id="{{ item.id() }}_last_update" class="py-1">{{ item.property.last_update.strftime('%d.%m.%Y %H:%M:%S') }}</td>
                <td id="{{ item.id() }}_last_change" class="py-1">{{ item.property.last_change.strftime('%d.%m.%Y %H:%M:%S') }}</td>
            </tr>
            {% endfor %}
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock bodytab1 %}
